{"ast":null,"code":"var _jsxFileName = \"/Users/vrajmehta/Downloads/Downloads/React:JavaScript/AIP_IOU/client/src/components/AddRewards/Index.js\";\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport \"./index.css\";\nimport { FaCoffee } from 'react-icons/fa';\nimport { GiChocolateBar, GiCupcake } from 'react-icons/gi';\nimport { FaLeaf, FaPizzaSlice } from 'react-icons/fa';\nimport { ImCross } from 'react-icons/im';\nimport { Button, message } from 'antd';\nimport axios from 'axios';\nimport cookie from 'react-cookies';\n\nclass AddRewards extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      postID: this.props.postID,\n      rewards: {},\n      // [{\n      //     user_id: \"\"\n      //     rewards:[\n      //         {\n      //             reward_name:\"\",qty:int\n      //         },\n      //         {\n      //             reward_name:\"\",qty:int\n      //         }\n      //     ]\n      // }]\n      rewardsEnum: []\n    };\n  }\n\n  componentDidMount() {\n    // clear rewardsEnum\n    this.setState({\n      rewardsEnum: []\n    }); // pull rewardsEnum\n\n    let responseData;\n    let selectedPostID = this.state.postID;\n    axios.get(`https://aip-v1.ts.r.appspot.com/api/posts/${selectedPostID}`).then(response => {\n      let particularPost_Rewards = response.data.rewards; // parse data into local states\n\n      this.setState({\n        rewards: particularPost_Rewards\n      });\n      axios.get(`https://aip-v1.ts.r.appspot.com/api/rewards`).then(response => {\n        responseData = response.data;\n        responseData.forEach(item => {\n          this.setState({\n            rewardsEnum: this.state.rewardsEnum.concat({\n              \"name\": item.reward_name,\n              \"qty\": 0\n            })\n          });\n        });\n        let newRewards = this.state.rewardsEnum;\n        newRewards.forEach(item => {\n          switch (item.name) {\n            case \"chocolate\":\n              item.name = \"Chocolate\";\n              break;\n\n            case \"coffee\":\n              item.name = \"Coffee\";\n              break;\n\n            case \"mint\":\n              item.name = \"Mint\";\n              break;\n\n            case \"cupcake\":\n              item.name = \"Cupcake\";\n              break;\n\n            case \"pizza\":\n              item.name = \"Pizza\";\n              break;\n          }\n        });\n        this.setState({\n          rewardsEnum: newRewards\n        });\n      }).then(() => {\n        let rewards = this.state.rewards;\n        let user_id = cookie.load(\"user_id\");\n        rewards.forEach(item => {\n          if (item.user_id == user_id) {\n            let currentRewards = item.rewards;\n            let rewardsEnum = this.state.rewardsEnum;\n            currentRewards.forEach(element => {\n              rewardsEnum.forEach(i => {\n                if (i.name == element.reward_name) {\n                  i.qty = element.qty;\n                }\n              });\n            });\n            this.setState({\n              rewardsEnum: rewardsEnum\n            });\n          }\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    }).catch(e => {\n      console.log(e);\n    });\n  }\n\n  onChangeRewards(ev, action, rewardType) {\n    let rewardsEnum = this.state.rewardsEnum;\n    rewardsEnum.forEach(item => {\n      if (item.name == rewardType) {\n        if (action == 'add') {\n          item.qty += 1;\n        } else {\n          if (item.qty > 0) {\n            item.qty -= 1;\n          }\n        }\n      }\n    });\n    this.setState({\n      rewardsEnum: rewardsEnum\n    });\n  }\n\n  handleAddRewards(ev, operationType) {\n    let rewardsEnum = this.state.rewardsEnum;\n    let newRewards = [];\n    rewardsEnum.forEach(item => {\n      if (item.qty > 0) {\n        newRewards = newRewards.concat(item);\n      }\n    }); // check if the addList is null\n\n    if (newRewards.length == 0) {\n      message.error(\"You have to add at least one reward first\");\n    } else {\n      let userID = cookie.load(\"user_id\");\n      let data = {\n        \"post_id\": `${this.state.postID}`,\n        // get logged userID from cookie JWT\n        \"user_id\": userID,\n        \"reward\": newRewards\n      };\n      axios.post(\"https://aip-v1.ts.r.appspot.com/api/posts/add_rewards\", data).then(res => {\n        let resMessage = res.data.message;\n        message.success(resMessage);\n        setTimeout(() => {\n          window.location.reload();\n        }, 2000);\n      }).catch(e => {\n        console.log(e);\n        message.error(\"Error from server,Please try again\");\n      });\n    }\n  }\n\n  render() {\n    let self = this;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addRewards\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addRewards-rewardsOption\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }\n    }, \"Please click the icon to add the corresponding rewards\", /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 21\n      }\n    }, this.state.rewardsEnum.map(function (item) {\n      let itemName = item.name;\n      let qty;\n\n      switch (itemName) {\n        case \"Chocolate\":\n        case \"chocolate\":\n          qty = item.qty;\n          return /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(GiChocolateBar, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 51\n            }\n          }), \" chocolate\"), /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"minus\", \"Chocolate\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 49\n            }\n          }, \"-\"), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-count\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 49\n            }\n          }, qty), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"add\", \"Chocolate\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 49\n            }\n          }, \"+\")));\n\n        case \"Coffee\":\n        case \"coffee\":\n          qty = item.qty;\n          return /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(FaCoffee, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 51\n            }\n          }), \" coffee\"), /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"minus\", \"Coffee\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 49\n            }\n          }, \"-\"), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-count\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 49\n            }\n          }, qty), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"add\", \"Coffee\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 49\n            }\n          }, \"+\")));\n\n        case \"Cupcake\":\n        case \"cupcake\":\n          qty = item.qty;\n          return /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(GiCupcake, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 51\n            }\n          }), \" cupcake\"), /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"minus\", \"Cupcake\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 49\n            }\n          }, \"-\"), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-count\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 49\n            }\n          }, qty), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"add\", \"Cupcake\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 49\n            }\n          }, \"+\")));\n\n        case \"Mint\":\n        case \"mint\":\n          qty = item.qty;\n          return /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(FaLeaf, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 51\n            }\n          }), \" mint\"), /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"minus\", \"Mint\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 49\n            }\n          }, \"-\"), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-count\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 49\n            }\n          }, qty), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"add\", \"Mint\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 49\n            }\n          }, \"+\")));\n\n        case \"Pizza\":\n        case \"pizza\":\n          qty = item.qty;\n          return /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(FaPizzaSlice, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 51\n            }\n          }), \" pizza\"), /*#__PURE__*/React.createElement(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 45\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"minus\", \"Pizza\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 49\n            }\n          }, \"-\"), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-count\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 49\n            }\n          }, qty), /*#__PURE__*/React.createElement(\"span\", {\n            className: \"addRewards-rewardsOption-countButton\",\n            onClick: ev => {\n              self.onChangeRewards(ev, \"add\", \"Pizza\");\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 49\n            }\n          }, \"+\")));\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addRewards-submitButton\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      onClick: this.handleAddRewards.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 21\n      }\n    }, \"Edit\")));\n  }\n\n}\n\nexport default AddRewards;","map":{"version":3,"sources":["/Users/vrajmehta/Downloads/Downloads/React:JavaScript/AIP_IOU/client/src/components/AddRewards/Index.js"],"names":["React","Link","FaCoffee","GiChocolateBar","GiCupcake","FaLeaf","FaPizzaSlice","ImCross","Button","message","axios","cookie","AddRewards","Component","constructor","props","state","postID","rewards","rewardsEnum","componentDidMount","setState","responseData","selectedPostID","get","then","response","particularPost_Rewards","data","forEach","item","concat","reward_name","newRewards","name","user_id","load","currentRewards","element","i","qty","catch","e","console","log","onChangeRewards","ev","action","rewardType","handleAddRewards","operationType","length","error","userID","post","res","resMessage","success","setTimeout","window","location","reload","render","self","map","itemName","bind"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport \"./index.css\";\nimport { FaCoffee } from 'react-icons/fa';\nimport { GiChocolateBar, GiCupcake } from 'react-icons/gi';\nimport { FaLeaf, FaPizzaSlice } from 'react-icons/fa';\nimport { ImCross } from 'react-icons/im';\nimport { Button, message } from 'antd';\nimport axios from 'axios';\nimport cookie from 'react-cookies';\n\n\nclass AddRewards extends React.Component{\n    \n    constructor(props){\n        super(props);\n        this.state={\n            postID:this.props.postID,\n            rewards: {},            \n            // [{\n            //     user_id: \"\"\n            //     rewards:[\n            //         {\n            //             reward_name:\"\",qty:int\n            //         },\n            //         {\n            //             reward_name:\"\",qty:int\n            //         }\n            //     ]\n            // }]\n            rewardsEnum:[],\n        }        \n    }\n\n    componentDidMount(){\n        // clear rewardsEnum\n        this.setState({\n            rewardsEnum:[]\n        });\n\n        // pull rewardsEnum\n        let responseData;\n        let selectedPostID = this.state.postID;\n        axios.get(`https://aip-v1.ts.r.appspot.com/api/posts/${selectedPostID}`)\n        .then( response => {\n            let particularPost_Rewards = response.data.rewards;\n            // parse data into local states\n            this.setState({\n                rewards:particularPost_Rewards\n            });\n\n            axios.get(`https://aip-v1.ts.r.appspot.com/api/rewards`)\n            .then(response =>{\n                responseData = response.data;\n                responseData.forEach(item => {\n                    this.setState({\n                        rewardsEnum:this.state.rewardsEnum.concat({\n                            \"name\":item.reward_name,\n                            \"qty\":0\n                        })\n                    });\n                });\n                let newRewards = this.state.rewardsEnum;\n                newRewards.forEach(item => {\n                    switch(item.name){\n                        case \"chocolate\":\n                            item.name = \"Chocolate\";\n                            break;\n                        case \"coffee\":\n                            item.name = \"Coffee\"\n                            break;\n                        case \"mint\":\n                            item.name = \"Mint\"\n                            break;\n                        case \"cupcake\":\n                            item.name = \"Cupcake\"\n                            break;\n                        case \"pizza\":\n                            item.name = \"Pizza\"   \n                            break;         \n                    }\n                });\n                this.setState({\n                    rewardsEnum:newRewards\n                });\n            })        \n            .then(() => {\n                let rewards = this.state.rewards;\n                let user_id = cookie.load(\"user_id\");\n                rewards.forEach(item => {\n                    if(item.user_id == user_id){\n                        let currentRewards = item.rewards;\n                        let rewardsEnum = this.state.rewardsEnum;\n                        currentRewards.forEach(element => {\n                            rewardsEnum.forEach(i => {\n                                if(i.name==element.reward_name){\n                                    i.qty = element.qty;\n                                }\n                            });\n                        });\n                        this.setState({\n                            rewardsEnum:rewardsEnum\n                        });\n                    }\n                });\n            })\n            .catch((e) => {\n                console.log(e);\n            })                \n        })\n        .catch((e) => {\n            console.log(e);\n        }) \n    }\n\n    onChangeRewards(ev,action,rewardType){\n        let rewardsEnum = this.state.rewardsEnum;\n        rewardsEnum.forEach(item => {\n            if(item.name == rewardType){\n                if(action =='add'){\n                    item.qty += 1;\n                }\n                else{\n                    if(item.qty > 0){\n                        item.qty -= 1;\n                    }                    \n                }\n            }\n        });\n        this.setState({\n            rewardsEnum:rewardsEnum\n        });\n    }\n\n\n    handleAddRewards(ev, operationType){\n        let rewardsEnum = this.state.rewardsEnum;\n        let newRewards=[];\n        rewardsEnum.forEach(item => {\n            if(item.qty > 0){\n                newRewards = newRewards.concat(item);\n            }\n        });\n        // check if the addList is null\n        if(newRewards.length == 0){\n            message.error(\"You have to add at least one reward first\");\n        }else{      \n            let userID = cookie.load(\"user_id\");\n            let data = {\n                \"post_id\":`${this.state.postID}`,\n                // get logged userID from cookie JWT\n                \"user_id\":userID,\n                \"reward\":newRewards\n            };\n            axios.post(\"https://aip-v1.ts.r.appspot.com/api/posts/add_rewards\",data)\n            .then( res => {\n                let resMessage = res.data.message;\n                message.success(resMessage);\n                setTimeout(() => {\n                    window.location.reload();\n                },2000);  \n            })\n            .catch((e) => {\n                console.log(e);\n                message.error(\"Error from server,Please try again\");\n            })\n        }\n        \n    }\n\n    render(){\n        let self = this;\n        return(\n            <div className=\"addRewards\">               \n                <div className=\"addRewards-rewardsOption\">\n                    Please click the icon to add the corresponding rewards \n                    <ul>\n                        {this.state.rewardsEnum.map(function(item){\n                            let itemName = item.name;\n                            let qty;\n                            switch(itemName){\n                                case \"Chocolate\":\n                                case \"chocolate\":\n                                    qty = item.qty;\n                                    return(\n                                        <li>\n                                            <span><GiChocolateBar /> chocolate</span>\n                                            <span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"minus\",\"Chocolate\")}}\n                                                >-</span>\n                                                <span className=\"addRewards-rewardsOption-count\">{qty}</span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"add\",\"Chocolate\")}}\n                                                >+</span>\n                                            </span>\n                                        </li>\n                                    )\n                                case \"Coffee\":\n                                case \"coffee\":\n                                    qty = item.qty;\n                                    return(\n                                        <li>\n                                            <span><FaCoffee /> coffee</span>\n                                            <span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"minus\",\"Coffee\")}}\n                                                >-</span>\n                                                <span className=\"addRewards-rewardsOption-count\">{qty}</span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"add\",\"Coffee\")}}\n                                                >+</span>\n                                            </span>\n                                        </li>\n                                    )\n                                case \"Cupcake\":\n                                case \"cupcake\":\n                                    qty = item.qty;\n                                    return(\n                                        <li>\n                                            <span><GiCupcake /> cupcake</span>\n                                            <span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"minus\",\"Cupcake\")}}\n                                                >-</span>\n                                                <span className=\"addRewards-rewardsOption-count\">{qty}</span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"add\",\"Cupcake\")}}\n                                                >+</span>\n                                            </span>\n                                        </li>\n                                    )\n                                case \"Mint\":\n                                case \"mint\":\n                                    qty = item.qty;\n                                    return(\n                                        <li>\n                                            <span><FaLeaf /> mint</span>\n                                            <span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"minus\",\"Mint\")}}\n                                                >-</span>\n                                                <span className=\"addRewards-rewardsOption-count\">{qty}</span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"add\",\"Mint\")}}\n                                                >+</span>\n                                            </span>\n                                        </li>\n                                    )\n                                case \"Pizza\":\n                                case \"pizza\":\n                                    qty = item.qty;\n                                    return(\n                                        <li>\n                                            <span><FaPizzaSlice /> pizza</span>\n                                            <span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"minus\",\"Pizza\")}}\n                                                >-</span>\n                                                <span className=\"addRewards-rewardsOption-count\">{qty}</span>\n                                                <span \n                                                    className=\"addRewards-rewardsOption-countButton\"\n                                                    onClick={(ev)=>{self.onChangeRewards(ev,\"add\",\"Pizza\")}}\n                                                >+</span>\n                                            </span>\n                                        </li>\n                                    )\n                            }                            \n                        })}                        \n                    </ul>      \n                </div>\n                <div className=\"addRewards-submitButton\" >\n                    <Button type=\"primary\" onClick={this.handleAddRewards.bind(this)}>Edit</Button>\n                </div>\n            </div>\n        );\n    }\n\n}\n\nexport default AddRewards;\n"]},"metadata":{},"sourceType":"module"}